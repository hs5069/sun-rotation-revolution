<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®‡å®™çš„æµ©ç€š_å­¸ç¿’é é¢_åœ°çƒå…¬è½‰çš„å¤ªé™½è»Œè·¡èˆ‡å››å­£è®ŠåŒ–</title>
    <style>
        /* å…¨å±€æ¨£å¼ */
        body {
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', 'Microsoft JhengHei', Arial, sans-serif;
            line-height: 1.8;
            margin: 0;
            padding: 20px;
            background-color: #f0f4f7; 
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 35px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        /* æ¨™é¡Œæ¨£å¼ */
        h1 {
            color: #0d47a1;
            text-align: center;
            border-bottom: 4px solid #42a5f5;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.3em;
        }
        h2 {
            color: #27ae60;
            margin-top: 40px;
            padding-left: 15px;
            border-left: 6px solid #27ae60;
            font-size: 1.5em;
        }

        /* å­¸ç”Ÿè³‡è¨Šæ¬„ä½ */
        .student-info {
            background-color: #f7fcf9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px dashed #a9d2a9;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .student-info label {
            margin-right: 15px;
            font-weight: bold;
            color: #555;
            flex-basis: 30%;
            min-width: 150px;
            margin-bottom: 10px;
        }
        .student-info input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-left: 5px;
        }

        /* é—œéµå­—é¡è‰² */
        .k1 { color: #e74c3c; font-weight: bold; } /* ç´…è‰² - å…¬è½‰/ä¸€å¹´ */
        .k2 { color: #2980b9; font-weight: bold; } /* è—è‰² - å‚¾æ–œ/è§’åº¦ */
        .k3 { color: #f39c12; font-weight: bold; } /* æ©˜è‰² - å¤è‡³/æœ€é«˜ */
        .k4 { color: #8e44ad; font-weight: bold; } /* ç´«è‰² - å†¬è‡³/æœ€ä½ */
        .k5 { color: #27ae60; font-weight: bold; } /* ç¶ è‰² - æ˜¥åˆ†ç§‹åˆ†/ç­‰é•· */

        /* å…§å®¹å€å¡Š */
        .lesson-block {
            padding: 15px;
            margin-bottom: 20px;
            border-left: 3px solid #d0f0d0;
        }

        /* è¨è«–å•é¡Œå€ */
        .discussion-section {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 3px solid #0d47a1;
        }
        .question-item {
            background-color: #f0f7f0;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            gap: 20px;
        }
        .question-content {
            flex: 3;
        }
        .question-image {
            flex: 1;
            min-width: 200px;
            max-width: 300px;
            text-align: center;
        }
        .question-image img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ccc;
            border-radius: 8px;
        }
        .question-item h3 {
            color: #2c3e50;
            font-size: 1.3em;
            margin-top: 0;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 5px;
        }
        .guidance {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
            padding: 10px;
            border-left: 4px solid #f39c12;
            background-color: #fffaf0;
        }
        textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            margin-top: 15px;
            border: 1px solid #a9d2a9;
            border-radius: 5px;
            resize: vertical;
        }
        .btn-submit {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            background-color: #27ae60;
            color: white;
            transition: background-color 0.3s;
        }
        .btn-submit:disabled {
            background-color: #a9d2a9;
            cursor: not-allowed;
        }
        .completion-status {
            margin-top: 10px;
            font-weight: bold;
            color: #e74c3c;
        }
        .completed {
            color: #27ae60;
        }
        
        /* å›é¥‹å€æ¨£å¼ */
        .feedback-section {
            margin-top: 40px;
            padding: 25px;
            border-top: 2px dashed #90caf9;
            background-color: #fbfdff;
            border-radius: 10px;
        }
        .feedback-section h3 {
            color: #1565c0;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        .feedback-question {
            margin-bottom: 20px;
        }
        .feedback-question p {
            font-weight: bold;
            color: #333;
        }
        .rating-options label {
            margin-right: 20px;
            font-weight: normal;
        }
        .rating-options input[type="radio"] {
            margin-right: 5px;
        }
        
        /* æœ€çµ‚æäº¤æŒ‰éˆ•æ¨£å¼ */
        .btn-submit-all {
            padding: 15px 30px;
            background-color: #2980b9; /* è—è‰² */
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.2em;
            transition: background-color 0.3s, opacity 0.3s;
            box-shadow: 0 4px #1f648d;
        }
        .btn-submit-all:hover:not(:disabled) {
            background-color: #1f648d;
        }
        .btn-submit-all:disabled {
            background-color: #aeb6bf;
            cursor: not-allowed;
            opacity: 0.8;
            box-shadow: none;
        }


        /* å°è¦½åˆ—æ¨£å¼ */
        .navigation {
            text-align: center;
            margin-top: 50px;
            padding-top: 25px;
            border-top: 1px solid #ddd;
        }
        .nav-btn {
            display: inline-block;
            padding: 12px 25px;
            margin: 0 20px;
            text-decoration: none;
            color: white;
            background-color: #0d47a1;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }
        .nav-btn:hover:not(.disabled) {
            background-color: #093175;
        }
        .nav-btn.disabled {
            background-color: #bbdefb;
            cursor: not-allowed;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒŒ å®‡å®™çš„æµ©ç€šï¼šåœ°çƒå…¬è½‰çš„å¤ªé™½è»Œè·¡èˆ‡å››å­£è®ŠåŒ–</h1>
        
        <div class="student-info">
            <label>ç­ç´š: <input type="text" name="class" required></label>
            <label>åº§è™Ÿ: <input type="text" name="seat" required></label>
            <label>å§“å: <input type="text" name="name" required></label>
        </div>
        
        <hr>

        <div class="lesson-block">
            <h2>é‹è¡Œè»Œé“ - å…¬è½‰</h2>
            <p>
                åœ°çƒé™¤äº†æ¯å¤©è‡ªè½‰ä¹‹å¤–ï¼Œé‚„æœƒæ²¿è‘—ä¸€æ¢æ¥è¿‘åœ“å½¢çš„è»Œé“ç’°ç¹å¤ªé™½é‹è¡Œï¼Œ
                é€™å€‹é‹å‹•å«åšã€Œ<span class="k1">å…¬è½‰</span>ã€ã€‚åœ°çƒå®Œæˆä¸€æ¬¡å…¬è½‰å¤§ç´„éœ€æ™‚ <span class="k1">ä¸€å¹´ï¼ˆ365åˆ1/4å¤©ï¼‰</span>ã€‚
                é›–ç„¶åœ°çƒç¹å¤ªé™½çš„è»Œé“ä¸¦éæ­£åœ“ï¼Œè€Œæ˜¯ç¨å¾®æ‹‰é•·çš„æ©¢åœ“å½¢ï¼Œä½†è»Œé“å½¢ç‹€ä¸¦ä¸æ˜¯å››å­£å½¢æˆçš„ä¸»è¦åŸå› ã€‚
            </p>
        </div>
        
        <div class="lesson-block">
            <h2>å››å­£çš„é—œéµ - åœ°è»¸å‚¾æ–œ</h2>
            <p>
                é€ æˆå››å­£è®ŠåŒ–çš„<span class="k2">é—œéµ</span>ï¼Œæ˜¯åœ°çƒ <span class="k2">è‡ªè½‰è»¸å‚¾æ–œç´„ 23.5 åº¦</span>ï¼Œ
                è€Œä¸”é€™å€‹å‚¾æ–œæ–¹å‘åœ¨å…¬è½‰éç¨‹ä¸­å¤§è‡´ä¿æŒä¸è®Šã€‚
                å› ç‚º<span class="k2">å‚¾æ–œè§’åº¦</span>èˆ‡å¤ªé™½å…‰ç…§å°„æ–¹å‘ä¸åŒï¼Œå°è‡´ä¸€å¹´ä¸­å¤ªé™½åœ¨å¤©ç©ºä¸­çš„<span class="k2">é«˜åº¦èˆ‡è·¯å¾‘æœƒç™¼ç”Ÿæ”¹è®Š</span>ã€‚
            </p>
        </div>
        
        <div class="lesson-block">
            <h2>æ¥µç«¯èˆ‡å¹³è¡¡</h2>
            <p>
                åœ¨ <span class="k3">å¤è‡³</span>æ™‚ï¼Œå¤ªé™½åœ¨ä¸­åˆçš„ä½ç½®é”åˆ°ä¸€å¹´ä¸­çš„<span class="k3">æœ€é«˜é»</span>ï¼Œç™½æ™æœ€é•·ï¼›
                åœ¨ <span class="k4">å†¬è‡³</span>æ™‚ï¼Œå¤ªé™½é«˜åº¦<span class="k4">æœ€ä½</span>ï¼Œç™½æ™æœ€çŸ­ã€‚
                <span class="k5">æ˜¥åˆ†èˆ‡ç§‹åˆ†</span> å‰‡æ˜¯å¤ªé™½ç›´å°„èµ¤é“ï¼Œå…¨çƒç™½å¤©èˆ‡é»‘å¤œ<span class="k5">å¹¾ä¹ä¸€æ¨£é•·</span>ã€‚
            </p>
        </div>
        
        <div class="lesson-block">
            <h2>ç¸½çµ</h2>
            <p>
                ç”±æ–¼å¤ªé™½å…‰ç…§çš„<span class="k2">è§’åº¦ã€æ™‚é–“èˆ‡èƒ½é‡è®ŠåŒ–</span>ï¼Œåœ°çƒæ‰æœƒå‡ºç¾ <span class="k5">æ˜¥ã€å¤ã€ç§‹ã€å†¬</span> å››å€‹å­£ç¯€ã€‚
            </p>
        </div>
        
        <hr>

        <div class="discussion-section">
            <h2>ğŸ“ è¨è«–èˆ‡æ€è€ƒ</h2>

            <div class="question-item" data-qid="Q1">
                <div class="question-content">
                    <h3>å•é¡Œ 1. è‹¥åœ°çƒè‡ªè½‰è»¸ä¸å†å‚¾æ–œï¼Œè€Œæ˜¯å®Œå…¨ç›´ç«‹ (0åº¦å‚¾è§’)ï¼Œè«‹æ¨æ¸¬ï¼š</h3>
                    <ol>
                        <li>å…¨çƒå„åœ°é‚„æœƒæœ‰å››å­£å—ï¼Ÿ</li>
                        <li>æ°£å€™å¯èƒ½å‡ºç¾ä»€éº¼è®ŠåŒ–ï¼Ÿ</li>
                    </ol>
                    <div class="guidance">
                        **ğŸ’¡ å›ç­”æ–¹å‘å»ºè­°ï¼š**
                        æ€è€ƒåœ°è»¸ç›´ç«‹å¾Œï¼Œå¤ªé™½ç›´å°„é»æœƒå›ºå®šåœ¨å“ªæ¢ç·¯ç·šï¼Ÿé€™æœƒå¦‚ä½•å½±éŸ¿ä¸åŒç·¯åº¦çš„æ—¥ç…§æ™‚é–“å’Œè§’åº¦è®ŠåŒ–ï¼Ÿ
                    </div>
                    <textarea name="ans_Q1" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ‚¨çš„æ¨æ¸¬èˆ‡è§£é‡‹..."></textarea>
                    <button class="btn-submit" data-qid="Q1" disabled>å®Œæˆä½œç­”ä¸¦é–å®š</button>
                    <div class="completion-status" id="status-Q1"></div>
                </div>
            </div>

            <div class="question-item" data-qid="Q2">
                <div class="question-content">
                    <h3>å•é¡Œ 2. è‹¥ä½ çœ‹åˆ°ä¸€å¼µå¹´é•·æ›²ç·šåœ–ï¼Œé¡¯ç¤ºæŸåŸå¸‚åœ¨ä¸€å¹´ä¸­ä¸­åˆå¤ªé™½é«˜åº¦çš„è®ŠåŒ–å½¢æˆä¸€æ¢æ³¢å½¢æ›²ç·šã€‚è«‹è§£é‡‹ï¼š</h3>
                    <p>ç‚ºä»€éº¼æ›²ç·šæœƒåœ¨**å¤è‡³**é™„è¿‘é”åˆ°æœ€é«˜é»ï¼Œåœ¨**å†¬è‡³**æœ€ä½é»ï¼Ÿ</p>
                    <div class="guidance">
                        **ğŸ’¡ å›ç­”æ–¹å‘å»ºè­°ï¼š**
                        è«‹å¼•ç”¨ã€Œåœ°è»¸å‚¾æ–œã€å’Œã€Œå…¬è½‰ä½ç½®ã€ä¾†è§£é‡‹å¤ªé™½é«˜åº¦å¦‚ä½•è®ŠåŒ–ï¼Œä¸¦èªªæ˜å¤ªé™½é«˜åº¦èˆ‡åœ°é¢æ¥æ”¶ç†±é‡çš„é—œä¿‚ã€‚
                    </div>
                    <textarea name="ans_Q2" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ‚¨çš„è§£é‡‹..."></textarea>
                    <button class="btn-submit" data-qid="Q2" disabled>å®Œæˆä½œç­”ä¸¦é–å®š</button>
                    <div class="completion-status" id="status-Q2"></div>
                </div>
                <div class="question-image">
                    <img src="14.png" alt="å¹´é•·æ›²ç·šåœ–ï¼Œé¡¯ç¤ºä¸€å¹´ä¸­ä¸­åˆå¤ªé™½é«˜åº¦è®ŠåŒ–">
                    <p>åœ–14ï¼šä¸­åˆå¤ªé™½ä»°è§’å¹´è®ŠåŒ–æ›²ç·šåœ– (æª”å: 14.png)</p>
                </div>
            </div>
        </div>

        <div class="feedback-section">
            <h2>â­ å­¸ç¿’å›é¥‹èˆ‡å»ºè­°</h2>

            <div class="feedback-question" data-fid="F1">
                <p>å›é¥‹1. é€™æ¨£çš„å­¸ç¿’æ–¹å¼ï¼Œä½ æœ‰æ›´äº†è§£èª²ç¨‹å…§å®¹å—ï¼Ÿ (1æ˜¯éå¸¸ä¸ç­è§£ï¼Œ4æ˜¯éå¸¸äº†è§£)</p>
                <div class="rating-options">
                    <label><input type="radio" name="f1" value="1" required> 1 (éå¸¸ä¸ç­è§£)</label>
                    <label><input type="radio" name="f1" value="2"> 2 (æœ‰é»ä¸ç­è§£)</label>
                    <label><input type="radio" name="f1" value="3"> 3 (å¤§éƒ¨åˆ†ç­è§£)</label>
                    <label><input type="radio" name="f1" value="4"> 4 (éå¸¸äº†è§£)</label>
                </div>
            </div>

            <div class="feedback-question" data-fid="F2">
                <p>å›é¥‹2. è‹¥æ˜¯ç”¨é€™æ¨£çš„å­¸ç¿’æ–¹å¼ï¼Œä½ å¸Œæœ›å¯ä»¥å†æ·»åŠ ä»€éº¼å…§å®¹ï¼Ÿ</p>
                <textarea name="f2" placeholder="è«‹å¡«å¯«æ‚¨çš„å»ºè­° (å¯ç•™ç©º)..."></textarea>
            </div>
        </div>
        <hr>

        <div style="text-align: center; margin: 30px 0;">
            <button class="btn-submit-all" id="submit-final-btn" disabled>æäº¤ç­”æ¡ˆåˆ°é›²ç«¯</button>
            <div id="submit-message" style="margin-top: 15px; font-weight: bold; min-height: 20px;"></div>
        </div>
        <hr>

        <div class="navigation">
            <a href="3.html" class="nav-btn">â† ä¸Šä¸€é </a>
            <a href="./5.html" class="nav-btn disabled" id="next-page-btn">ä¸‹ä¸€é  â†’</a>
        </div>
    </div>

    <script>
        // !! é‡è¦ï¼šå·²æ›¿æ›ç‚ºæ‚¨éƒ¨ç½² Google Apps Script å¾Œç²å¾—çš„ Web App URL !!
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzkyZTFWrfVvOMchXu217E8wf6WEJum4lGS5DYO-_D7ZAsIcVq5JdFznIed6QKnC9n7TQ/exec';
        
        // è¿½è¹¤å•é¡Œçš„å®Œæˆç‹€æ…‹ (å¿…é ˆé€šéå–®é¡Œæäº¤æŒ‰éˆ•é–å®š)
        const quizStatus = { 'Q1': false, 'Q2': false };

        /**
         * æª¢æŸ¥æ‰€æœ‰å¿…å¡«æ¬„ä½ã€è¨è«–å•é¡Œå’Œå›é¥‹1æ˜¯å¦å®Œæˆ
         */
        function checkAllCompleted() {
            // æª¢æŸ¥å­¸ç”Ÿè³‡è¨Šæ¬„ä½
            const infoInputs = document.querySelectorAll('.student-info input[required]');
            const infoComplete = Array.from(infoInputs).every(input => input.value.trim() !== '');

            // æª¢æŸ¥è¨è«–å•é¡Œ Q1, Q2 æ˜¯å¦é–å®š
            const questionsComplete = quizStatus.Q1 && quizStatus.Q2;
            
            // æª¢æŸ¥å›é¥‹ F1 æ˜¯å¦é¸å–
            const feedback1Complete = document.querySelector('input[name="f1"]:checked') !== null;
            
            // æª¢æŸ¥æ•´é«”å®Œæˆç‹€æ…‹ (å­¸ç”Ÿè³‡è¨Š + è¨è«–é¡Œé–å®š + å›é¥‹1é¸å–)
            const allComplete = infoComplete && questionsComplete && feedback1Complete;

            const submitFinalBtn = document.getElementById('submit-final-btn');

            // å•Ÿç”¨/ç¦ç”¨ æäº¤ç­”æ¡ˆæŒ‰éˆ•
            submitFinalBtn.disabled = !allComplete;
        }

        /**
         * ç›£è½è¼¸å…¥è®ŠåŒ–ï¼Œæ§åˆ¶æŒ‰éˆ•å•Ÿç”¨ç‹€æ…‹
         */
        function setupInputListeners() {
            // ç›£è½è¨è«–å•é¡Œçš„æ–‡æœ¬è¼¸å…¥
            document.querySelectorAll('.question-item').forEach(block => {
                const qid = block.dataset.qid;
                const textarea = block.querySelector(`textarea[name="ans_${qid}"]`);
                const submitBtn = block.querySelector(`.btn-submit[data-qid="${qid}"]`);
                
                submitBtn.disabled = true;

                textarea.addEventListener('input', () => {
                    // æª¢æŸ¥æ˜¯å¦æœ‰è¶³å¤ çš„æ–‡æœ¬ (è‡³å°‘5å€‹å­—å…ƒï¼Œä¸”æœªé–å®š)
                    if (!textarea.disabled) {
                        submitBtn.disabled = textarea.value.trim().length < 5; 
                    }
                });
            });

            // ç›£è½å­¸ç”Ÿè³‡è¨Šæ¬„ä½å’Œå›é¥‹ F1 è®ŠåŒ–
            document.querySelectorAll('.student-info input, input[name="f1"]').forEach(input => {
                input.addEventListener('input', checkAllCompleted);
                input.addEventListener('change', checkAllCompleted);
            });
        }

        /**
         * è™•ç†å–®é¡Œå•é¡Œæäº¤ (é–å®šç­”æ¡ˆ)
         */
        function handleSubmit(qid) {
            const block = document.querySelector(`.question-item[data-qid="${qid}"]`);
            const textarea = block.querySelector(`textarea[name="ans_${qid}"]`);
            const submitBtn = block.querySelector(`.btn-submit[data-qid="${qid}"]`);
            const statusDiv = document.getElementById(`status-${qid}`);

            if (textarea.value.trim().length >= 5) { // æª¢æŸ¥æ˜¯å¦æ»¿è¶³æœ€å°å­—å…ƒæ•¸
                textarea.disabled = true; // é–å®šæ–‡æœ¬æ¡†
                submitBtn.disabled = true; // é–å®šæäº¤æŒ‰éˆ•
                statusDiv.innerHTML = 'âœ… **å·²å®Œæˆä½œç­”ä¸¦é–å®š**';
                statusDiv.classList.add('completed');
                quizStatus[qid] = true;
            } else {
                statusDiv.innerHTML = 'è«‹è¼¸å…¥è‡³å°‘ 5 å€‹å­—å…ƒçš„ç­”æ¡ˆã€‚';
                statusDiv.classList.remove('completed');
                quizStatus[qid] = false;
            }

            checkAllCompleted(); 
        }
        
        /**
         * è™•ç†æœ€çµ‚æäº¤ (ä¸Šå‚³è‡³ Apps Script)
         */
        function submitToCloud() {
            const submitFinalBtn = document.getElementById('submit-final-btn');
            const submitMessageDiv = document.getElementById('submit-message');
            const nextBtn = document.getElementById('next-page-btn');

            // é–å®šæŒ‰éˆ•é˜²æ­¢é‡è¤‡é»æ“Š
            submitFinalBtn.disabled = true;
            submitMessageDiv.innerHTML = 'ğŸ“¤ **æ­£åœ¨æäº¤ï¼Œè«‹ç¨å€™...**';
            submitMessageDiv.style.color = '#e67e22';
            nextBtn.classList.add('disabled'); // æäº¤ä¸­ï¼Œä¸‹ä¸€é é–å®š

            // æ”¶é›†æ‰€æœ‰æ•¸æ“š (åŒ…æ‹¬å›é¥‹ F1, F2)
            const data = {};
            data.class = document.querySelector('input[name="class"]').value.trim();
            data.seat = document.querySelector('input[name="seat"]').value.trim();
            data.name = document.querySelector('input[name="name"]').value.trim();
            data.ans_Q1 = document.querySelector('textarea[name="ans_Q1"]').value.trim();
            data.ans_Q2 = document.querySelector('textarea[name="ans_Q2"]').value.trim();
            data.f1 = document.querySelector('input[name="f1"]:checked') ? document.querySelector('input[name="f1"]:checked').value : '';
            data.f2 = document.querySelector('textarea[name="f2"]').value.trim(); // å›é¥‹2å¯ç•™ç©º

            // ä½¿ç”¨ FormData æº–å‚™ç™¼é€
            const formData = new FormData();
            for (const key in data) {
                formData.append(key, data[key]);
            }

            fetch(WEB_APP_URL, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                if (result.result === 'success') {
                    submitMessageDiv.innerHTML = 'ğŸ‰ **æäº¤æˆåŠŸï¼** è³‡æ–™å·²å®‰å…¨ä¸Šå‚³åˆ°é›²ç«¯è©¦ç®—è¡¨ã€‚';
                    submitMessageDiv.style.color = '#27ae60';
                    // è§£é–ä¸‹ä¸€é æŒ‰éˆ•
                    nextBtn.classList.remove('disabled');
                } else {
                    submitMessageDiv.innerHTML = `âŒ **æäº¤å¤±æ•—ï¼** éŒ¯èª¤ï¼š${result.message}ã€‚è«‹æª¢æŸ¥ç¶²è·¯æˆ–è¯ç¹«ç®¡ç†å“¡ã€‚`;
                    submitMessageDiv.style.color = '#e74c3c';
                    submitFinalBtn.disabled = false; // å…è¨±é‡è©¦
                }
            })
            .catch(error => {
                submitMessageDiv.innerHTML = `âŒ **é€£ç·šéŒ¯èª¤ï¼** ç„¡æ³•é€£æ¥åˆ°æœå‹™ã€‚${error.message}ã€‚è«‹æª¢æŸ¥ç¶²è·¯ã€‚`;
                submitMessageDiv.style.color = '#e74c3c';
                submitFinalBtn.disabled = false; // å…è¨±é‡è©¦
            });
        }


        document.addEventListener('DOMContentLoaded', () => {
            // è¨­å®šå–®é¡Œæäº¤æŒ‰éˆ•çš„äº‹ä»¶ (é–å®šå–®é¡Œä½œç­”)
            document.querySelectorAll('.btn-submit[data-qid]').forEach(button => {
                const qid = button.dataset.qid;
                button.addEventListener('click', () => handleSubmit(qid));
            });
            
            // è¨­å®šæœ€çµ‚æäº¤æŒ‰éˆ•çš„äº‹ä»¶ (ä¸Šå‚³è‡³é›²ç«¯)
            document.getElementById('submit-final-btn').addEventListener('click', submitToCloud);


            // è¨­å®šè¼¸å…¥ç›£è½å™¨
            setupInputListeners();
            
            // åˆå§‹æª¢æŸ¥
            checkAllCompleted();

            // é˜»æ­¢ä¸‹ä¸€é æŒ‰éˆ•åœ¨æœªè§£é–æ™‚çš„å°èˆª
            document.getElementById('next-page-btn').addEventListener('click', function(e) {
                if (this.classList.contains('disabled')) {
                    e.preventDefault();
                    alert('âš ï¸ è«‹å…ˆé»æ“Šã€Œæäº¤ç­”æ¡ˆåˆ°é›²ç«¯ã€æŒ‰éˆ•ä¸¦ç¢ºèªæˆåŠŸå¾Œï¼Œæ‰èƒ½å‰å¾€ä¸‹ä¸€é ï¼');
                }
            });
        });
    </script>
</body>
</html>